<!doctype>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>瀑布流</title>
	<style type="text/css">
		*{
	margin:0;
	padding:0;
}
#main{
	position:relative;
	margin:0,auto;
}
.box
{
	padding-left:10px;
	padding-top:10px;
	float:left;
}
.pic{
	padding:10px;
	border:1px solid #ccc;
	border-radius:5px;
	box-shadow:0,0,5px,5px;
}
.pic img{
	width:190px;
}

	</style>
</head>
<body>
	
	<div id="main">
		<div class="box">
			<div class="pic">
				<img src="image/0.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/1.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/2.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/3.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/4.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/5.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/6.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/7.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/8.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/9.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/10.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/11.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/12.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/13.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/14.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/15.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/16.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/17.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/18.jpg">
			</div>
		</div>
		<div class="box">
			<div class="pic">
				<img src="image/19.jpg">
			</div>
		</div>
	
	</div>
</body>
<script type="text/javascript">
	window.onload=function(){
	rankpic();
	var dataInt={"data":[{"src":"1.jpg"},{"src":"2.jpg"},{"src":"3.jpg"},{"src":"4.jpg"},{"src":"5.jpg"},{"src":"6.jpg"}]}
	window.onscroll=function()
	{
		if(addPic())
		{
			for(var i=0;i<dataInt.data.length;i++)
			{
				var img=document.createElement('img');
				img.src="image/"+dataInt.data[i].src;
				var pic = document.createElement("div");
				pic.className="pic";
				pic.appendChild(img);
				var box = document.createElement('div');
				box.className="box";
				box.appendChild(pic);
				var main = document.getElementById("main");
				main.appendChild(box);

			}
			rankpic();

		}
	}
}
function rankpic()
{
			var main = document.getElementById("main");
		var boxs = main.getElementsByClassName("box");
		var picWidth = boxs[0].offsetWidth; //获取一个box的宽度
		var cols = Math.floor(document.documentElement.clientWidth/picWidth);//表示有多少列
		main.style.cssText= "width:"+picWidth*cols +'px; margin:0 auto';
		var boxHeight = new Array();
		for(var i =0;i<boxs.length;i++)
		{
			if(i<cols)
				boxHeight.push(boxs[i].offsetHeight);
			else{
				var minHeight = Math.min.apply(null,boxHeight)
				var index = boxHeight.indexOf(minHeight);
				boxs[i].style.position ="absolute";
				boxs[i].style.top =minHeight+'px';
				boxs[i].style.left = boxs[index].offsetLeft+'px';
				boxHeight[index]+= boxs[i].offsetHeight;
			}
		}
}
function addPic()
{
		var main = document.getElementById("main");
		var boxs = main.getElementsByClassName("box");
		var bHight =boxs[boxs.length-1].offsetTop +Math.floor(boxs[boxs.length-1].offsetHeight/2);
		var sHight = document.documentElement.scrollTop||document.body.scrollTop;
		var clientHeight = document.documentElement.clientHeight||document.body.clientHeight;
		console.log(bHight);
		console.log(sHight);
		console.log(clientHeight);
		return (sHight+clientHeight>bHight);
}
</script>
</html>